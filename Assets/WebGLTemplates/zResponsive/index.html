<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>{{{ PRODUCT_NAME }}}</title>

	<meta name="viewport"
		  content="width=device-width,height=device-height,initial-scale=1.0,viewport-fit=cover,user-scalable=no,shrink-to-fit=yes">

	<style>
		:root{
			/* ↓ hier feintunen */
			--circle-size: 176px;         /* Ziel-Durchmesser des weißen Kreises */
			--circle-offset-y: -40px;
			--gap-under-circle: 18px;

			--wordmark-min: 200px;
			--wordmark-max: 420px;

			--progress-height: 14px;
			--accent-orange: #F36E21;
		}

		html, body {
			background: linear-gradient(180deg, #14305D 0%, #0C1A2D 100%);
			width: 100%; height: 100%;
			margin: 0; padding: 0; overflow: visible;
		}

		#container {
			position: absolute;
			box-sizing: border-box;
			background: transparent !important;
			display: block;
		}
		#container canvas { position: absolute; }
		#container canvas[data-pixel-art="true"] {
			position: absolute;
			image-rendering: optimizeSpeed;
			image-rendering: -webkit-crisp-edges;
			image-rendering: -moz-crisp-edges;
			image-rendering: -o-crisp-edges;
			image-rendering: crisp-edges;
			image-rendering: -webkit-optimize-contrast;
			image-rendering: optimize-contrast;
			image-rendering: pixelated;
			-ms-interpolation-mode: nearest-neighbor;
		}

		@media (hover: hover) and (pointer: fine) { #container { outline: 5px solid white; } }
		@media (hover: none)  and (pointer: coarse){ #container { outline: none; } }

		/* Loading-Overlay */
		#loading{
			position: absolute; inset: 0;
			display:flex; flex-direction:column; align-items:center; justify-content:center;
			z-index:10; pointer-events:none; transition:opacity .35s ease;
		}
		#loading.hidden{ opacity:0; }

		.brand-mark{
			transform: translateY(var(--circle-offset-y));
			margin-bottom: var(--gap-under-circle);
			/* nichts erzwingen – das Bild steuert die Größe */
		}
		/* WICHTIG: nur HÖHE setzen, Breite automatisch → keine Verzerrung */
		.brand-mark img{
			height: var(--circle-size);
			width: auto;
			display:block;
		}

		.wordmark{
			width: clamp(var(--wordmark-min), 60%, var(--wordmark-max));
			height:auto; display:block;
			filter: drop-shadow(0 6px 18px rgba(0,0,0,.25));
		}

		.progress{
			width: clamp(220px, 70%, 380px);
			height: var(--progress-height);
			background:#fff; border-radius:8px; overflow:hidden;
			box-shadow: 0 6px 18px rgba(0,0,0,.25);
			margin-top: 20px;
		}
		.progress__fill{
			width:0%; height:100%; background:var(--accent-orange);
			border-radius:8px 0 0 8px; transition: width .2s ease;
		}
	</style>
</head>

<body>
<div id="container">
	<div id="loading" role="status" aria-live="polite" aria-label="Ladevorgang">
		<div class="brand-mark">
			<img src="Images/Kite_Logo_im_Kreis.png" alt="Kite Logo im weißen Kreis">
		</div>
		<img class="wordmark" src="Images/kite_logo_ohne_II.png" alt="kite Wortmarke">
		<div class="progress" aria-hidden="true">
			<div id="progress-fill" class="progress__fill"></div>
		</div>
	</div>

	<canvas id="game-canvas" data-pixel-art="false"></canvas>

	<script src="Build/{{{ LOADER_FILENAME }}}"></script>
	<script>
		var canvas = document.querySelector("#game-canvas");
		var config = {
			dataUrl: "Build/{{{ DATA_FILENAME }}}",
			frameworkUrl: "Build/{{{ FRAMEWORK_FILENAME }}}",
			codeUrl: "Build/{{{ CODE_FILENAME }}}",
			streamingAssetsUrl: "StreamingAssets",
			companyName: "{{{ COMPANY_NAME }}}",
			productName: "{{{ PRODUCT_NAME }}}",
			productVersion: "{{{ PRODUCT_VERSION }}}",
			autoSyncPersistentDataPath: true
		};

		const fillEl = document.getElementById("progress-fill");
		const loadingEl = document.getElementById("loading");
		function progressHandler(progress){
			const pct = Math.max(0, Math.min(100, Math.round(progress*100)));
			fillEl.style.width = pct + "%";
			if (pct >= 100 || progress >= 0.999){
				setTimeout(()=>loadingEl.classList.add("hidden"),150);
				setTimeout(()=>loadingEl.remove(),600);
			}
		}

		function onResize(){
			var container = canvas.parentElement;
			var isDesktop = matchMedia("(hover: hover) and (pointer: fine)").matches;
			var w,h,left,top;
			if(isDesktop){
				var vw = innerWidth, vh = innerHeight;
				h = vh; w = Math.floor(h/2);
				if (w > vw){ w = vw; h = Math.floor(w*2); }
				left = Math.floor((vw - w)/2); top = 0;
			}else{
				var vv = visualViewport || { width: innerWidth, height: innerHeight, offsetLeft:0, offsetTop:0 };
				w = vv.width; h = vv.height; left = vv.offsetLeft; top = vv.offsetTop;
			}
			container.style.width = w+"px"; container.style.height = h+"px";
			container.style.left = left+"px"; container.style.top = top+"px";
			canvas.style.width = w+"px"; canvas.style.height = h+"px";
		}

		createUnityInstance(canvas, config, progressHandler).then(function(instance){
			canvas = instance.Module.canvas;
			onResize();
		});

		addEventListener("resize", onResize);
		onResize();

		const meta = document.createElement("meta");
		meta.name = "viewport";
		meta.content = "width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes";
		document.head.appendChild(meta);
	</script>

	<script> function logMessage(m){ console.log(m); } </script>
</div>
</body>
</html>
